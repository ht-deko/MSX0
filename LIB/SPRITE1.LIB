(*
    SPRITE1.LIB
*)

type
  TSpDat8 = array [0..7] of byte;
  TSpDat16 = array [0..31] of byte;
  TSpAtr =
    record
      Row: byte;
      Col: byte;
      PtnNo: byte;
      Color: byte;
    end;

var
  _PtnAddr: Integer;
  _AtrAddr: Integer;
  _PtnSize: byte;

procedure InitSprite(Size: byte);
begin
  _PtnAddr := PattTable;
  _AtrAddr := TranspTable;
  if (Size mod 2) = 0 then
    _PtnSize := 8
  else
    _PtnSize := 32;
  ClearSprites;
  SpriteSize(Size);
end;

function CalcPtnAddr(PtnNo: byte): Integer;
begin
  CalcPtnAddr := _PtnAddr + PtnNo * _PtnSize;
end;

function CalcAtrAddr(Plane: byte): Integer;
begin
  CalcAtrAddr := _AtrAddr + Plane * 4;
end;

procedure SetSpritePtn(Ptn: byte; var Ptn: byte);
begin
  LibRegs.BC := _PtnSize;
  LibRegs.DE := _PtnAddr + Ptn * LibRegs.BC;
  LibRegs.HL := Addr(Ptn);
  Bios($005C);
end;

procedure PutSprite(Plane: byte; X, Y: byte; Color: byte; PtnNo: byte);
var
  Atr: TSpAtr;
begin
  Atr.Col := X;
  Atr.Row := Y;
  Atr.PtnNo := PtnNo;
  Atr.Color := Color;
  LibRegs.HL := Addr(Atr);
  LibRegs.BC := 4;
  LibRegs.DE := _AtrAddr + Plane * LibRegs.BC;
  Bios($005C);
end;

procedure SetSpriteAtr(Plane: byte; var Atr: TSpAtr);
begin
  LibRegs.HL := Addr(Atr);
  LibRegs.BC := 4;
  LibRegs.DE := _AtrAddr + Plane * LibRegs.BC;
  Bios($005C);
end;

